syntax = "proto3";

package mrnet.v1;
option go_package = "/authentication;authenticationpb";

service LoginService {
    rpc LoginWithCredentials (UserLoginDetails) returns (LoginResponse);
    rpc LoginWithToken (JWTToken) returns (LoginResponse);
    rpc RenewAccessToken (RenewJWTToken) returns (JWTToken);
}

service LogoutService {
    rpc LogoutWithAccessToken (LogoutRequest) returns (LogoutResponse);
}

service SignupService {
    rpc Signup (UserSignupDetails) returns (LoginResponse);
}

service ModificationService {
    rpc RequestChangePassword (RequestChangePasswordRequest) returns (ModificationResponse);
    rpc ChangePassword (PasswordResetRequest) returns (ModificationResponse);
    rpc ChangeUserId (UserIdResetRequest) returns (ModificationResponse);
}

message UserLoginDetails {
    string id = 1;
    string passwordHash = 2;
}

message LoginResponse {
    bool loginSuccess = 1;
    string refreshJwtToken = 2;
    string accessJwtToken = 3;
    string error = 4;
}

message JWTToken {
    string accessJwtToken = 1;
}

message UserSignupDetails {
    string email = 1;
    string id = 2;
    string passwordHash = 3;
}

message RequestChangePasswordRequest {
    string email = 1;
}

message PasswordResetRequest {
    string email = 1;
    string secretHash = 2;
    string newPasswordHash = 3;
}

message UserIdResetRequest {
    string oldId = 1;
    string newId = 2;
    string passwordHash = 3;
}

message ModificationResponse {
    bool success = 1;
    string error = 2;
}

message RenewJWTToken {
    string refreshToken = 1;
}

message LogoutRequest {
    string id = 1;
    string accessToken = 2;
}

message LogoutResponse {
    bool success = 1;
    string error = 2;
}